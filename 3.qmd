---
title: "Geocoding Truck Stops Update"
author: "William Co"
date: today
format:
  pdf:
    toc: true
    number-sections: true
    geometry: margin=1in
    fig-pos: "H"
  html:
    toc: true
    number-sections: true
    theme: cosmo
abstract: |
  This report documents the geocoding validation process, highlighting discrepancies arising from integrating data sources like Yelp and Yellow Pages. Despite matching entries by phone number, these platforms introduce a high rate of false positives. We apply a variety of filtering to correct for this. We then provide a detailed account of the types of errors observed and offer a numerical estimate of the remaining discrepancies. These errors represent a small proportion of the entire dataset, affecting approximately 17 locations.

keywords: [geocoding, data cleaning, location accuracy, Yelp, Yellow Pages, truck stops]
---

# Progress

## Bug Fixes on Scraping Code
This section details the iterative process of refining our geocoding validation. An initial update addressed a bug in latitude and longitude extraction from the "RVers and Travelers" website. Subsequent analysis focused on resolving discrepancies between different data sources.

## New Matching Process

Initially, we attempted to extract geo-coordinates through a reduction approach. While this method allowed us to observe various geo-coordinates from different sources, it provided no reliable mechanism to determine which coordinates were accurate. This approach proved complex and prone to error due to the scale of the data. 

To address these limitations, we developed a more effective strategy based on geographic proximity matching. This method involves calculating the minimum distance between corresponding locations from different data sources, with the closest geographic match considered the most accurate. This distance-based validation approach significantly reduced the number of discrepancies in our dataset. This method operates on the intuition that when two independent data sources yield similar coordinates for the same location, their agreement likely indicates the correct position.

## Previous Matching Process

One big problem with the previous matching process was that we can not accurately rely on input data, as a means to compare. For example, a place might be mark as Zipcode 12345 but its true zipcode is 54321. By using the nearest distance-based validation approach, we bypass this concern. 

During this process, we identified postal code input errors as a primary source of location discrepancies. Our initial analysis, revealed a substantial number of locations with discrepancies of less than one mile (see Figure 1).

![Analysis of discrepancies less than one mile.](Images/2.png){#fig-less-than-one-mile}

Including all outliers, the dataset initially appeared as shown in Figure 2.

![Dataset including all outliers.](Images/3.png){#fig-outliers}

After implementing the minimum distance comparison method, we successfully reduced the number of locations with discrepancies greater than one mile from seven to five. The results of this improved approach are visualized in Figure 3.

![Results of the minimum distance comparison approach.](Images/4.png){#fig-min-distance}

Our new methodology resulted in only five locations exhibiting discrepancies of more than one mile, representing a significant improvement in overall data accuracy.

# Manual Verification of Remaining Discrepancies

The five remaining locations with significant discrepancies were manually verified. The analysis revealed no single, discernible pattern to the errors. No single data source was responsible for the errors.  Instead, they fall into two main categories:

1.  **Geocoding Inaccuracy**: In some cases, the geocoding service returned coordinates with a spatial offset from the actual address. For a given address intended to map to location *X*, the service returned coordinates at *X + E*, where *E* represents the spatial error.

2.  **Non-Physical Addresses**: Another source of error was the presence of Post Office (P.O.) boxes instead of physical street addresses in the source data.

![An example of a P.O. Box listed as an address.](Images/Screenshot 2025-08-03 180347.png){#fig-po-box}

## Results
Following the matching process, all locations have been reconciled to within 200 meters. The next step involves finalizing geo-coordinates by using the midpoints across two slightly different coordinates. 

A potential fourth source of geo-coordinates is the Google Geocoding API, which can be used in conjunction with I-exit data. However, this approach is more complex, as not all addresses are formatted correctly and not all entries correspond to highway exits. Not to mention, matching based on exit location can introduce errors greater than one mile.

MapQuest and TruckMap.com are good resources for manually matching these remaining locations.

I completed the manual entries. Below is an example of the process.

![Manual Matches Example](Images/Screenshot 2025-08-04 134651.png){#fig-manual}

After completing these steps, 13 locations remain that require manual correction. Most of these are old (2008 and earlier) entries, which likely account for the observed errors. No consistent pattern was identified among these remaining discrepancies (aside from age).

The finalized geocoded dataset is available at the following link:
[Final Geocoded Dataset (10.csv)](https://github.com/WilliamClintC/Geocoding_Documentation/blob/main/Notebooks/10.csv)

Given the small (13) number of unresolved cases, further automation is not justified, nor is it likely to be reliable. Though, we are open hearing any other thoughts on the matter. 

These leaves two options. Manual matching against geo-coordinate (Google Geocoding API & I-Exit) matching.

The final map is as follows: [Interactive Map of Geocoded Truck Stops](https://github.com/WilliamClintC/Geocoding_Documentation/blob/main/Notebooks/9.html)

![Final geocoded truck stops visualization showing the complete dataset after validation and manual correction.](Images/Screenshot 2025-08-04 174216.png){#fig-final-map}